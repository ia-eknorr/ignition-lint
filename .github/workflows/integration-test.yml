name: Integration Test

on:
  pull_request:
    branches:
      - main

jobs:
  integration-test:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Test with bad file
        id: lint-bad
        continue-on-error: true
        run: python src/ignition-lint.py --files tests/integration/bad/view.json --parameter_style camelCase --component_style PascalCase
      - name: Test with good file
        id: lint-good
        run: python src/ignition-lint.py --files tests/integration/good/view.json --parameter_style camelCase --component_style PascalCase
      - name: Test with no files
        id: lint-empty
        run: python src/ignition-lint.py --files "" --parameter_style camelCase --component_style PascalCase
      - name: Check test results
        continue-on-error: false
        run: |
          if [ ${{ steps.lint-good.outcome }} == 'success' ] && [ ${{ steps.lint-bad.outcome }} == 'failure' ] && [ ${{ steps.lint-empty.outcome }} == 'success' ]; then
            echo "All tests passed"
            exit 0
          else
            echo "One or more tests failed"
            exit 1
          fi
