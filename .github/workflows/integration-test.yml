name: Integration Test

on:
  push: 

jobs:
  main-validation:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Test with good file
        id: lint-good
        continue-on-error: true
        run: python src/lint-ignition-views.py ./tests/integration/good/view.json
      
      - name: Test with bad file
        id: lint-bad
        run: python src/lint-ignition-views.py ./tests/integartion/bad/view.json
      
      - name: Check test results
        continue-on-error: false
        run: |
          if [ ${{ steps.lint-good.outcome }} == 'success' ] && [ ${{ steps.lint-bad.outcome }} == 'failure' ]; then
            echo "All tests passed"
            exit 0
          else
            echo "One or more tests failed"
            exit 1
          fi
